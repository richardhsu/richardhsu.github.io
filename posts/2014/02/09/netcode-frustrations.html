<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
  <title>Netcode</title>
  <meta name="author" content="Richard Hsu">
  <meta name="keywords" content="richard hsu, blog, ideas, thoughts" />
  <meta name="description" content="Richard Hsu's blog about anything and everything." />
  <meta name="viewport" content="width=device-width" />
  <meta name="google-site-verification" content="OmxMsLFmNXKOxX9hZRyFW9sZcita0lpB6lfqUuZQxZs" />
  <link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="http://www.richardhsu.me/css/syntax.css" type="text/css" media="screen, projection" />
  <link rel="stylesheet" href="http://www.richardhsu.me/css/style.css" type="text/css" media="screen, projection" />
  <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
</head>
<body>
<div id="header">
  <div class="content-jar clearfix">
    <div class="avatar left"><img src="http://www.richardhsu.me/images/profile.jpeg" height="100" width="100" /></div>
    <div class="description">
      <strong>Welcome to Richard Hsu's blog!</strong><br />
      Here, I explore different subjects such as food, programming, tv shows, movies, and really anything
      I find in life! I hope to share my journey and adventures with you! Thanks for visiting!
    </div>
    <ul class="pages">
      <li><a href="http://www.richardhsu.me"><i class="fa fa-home"></i> Home</a></li>
      <li><a href="http://www.richardhsu.me/search.html"><i class="fa fa-search"></i> Search Blog</a></li>
    </ul>
  </div>
</div>
<div id="container">
  <div class="content-jar listing">
    <!-- Beginning of Posts Listing -->
    <div class="back-to-index"><a href="http://www.richardhsu.me">Back to Index</a></div>
<div class="post">
  <div class="post-header">
    <h1><a href="/posts/2014/02/09/netcode-frustrations.html">Netcode</a></h1>
    <span class="post-date"><i class="fa fa-calendar"></i> February 9, 2014</span>
    <span class="post-tags"><i class="fa fa-tag"></i>
      <a href="/tag/gaming" rel="tag">Gaming</a>, <a href="/tag/bf4" rel="tag">BF4</a>, <a href="/tag/networking" rel="tag">Networking</a>
    </span>
  </div>
  <p>Things have gotten a lot busier in school. Longer grading periods, more reading,
longer assignments, but I always make time for unwinding at least once a day. My
main source of unwinding is playing <a href="http://www.battlefield.com/">Battlefield 4</a>. If you play, this
weekend there&#39;s actually a Double XP Boost going on for Player Appreciation
Month, which by the way was only announced on Facebook and seems very odd that
no official announcement was made on the actual <a href="http://battlelog.battlefield.com/bf4/">Battlelog</a> website.
Anyways, although it is a fun game it can be stressful but in a good way ...
until we get to the frustrations of it all.</p>

<p>The game can be very buggy at times and it can get quite annoying when I&#39;m just
trying to have fun. I&#39;m okay with the stresses generated by the gameplay of
attacking an objective with enemies ready to swarm in and kill. I&#39;m okay with
the stresses of being shocked around a corner by a shotgun. But playing a game
in which bugs introduce possible preceived unfairness is not okay. But then
again when I think about how massive this game is with at least one server
and near 64 or more participants, I am inspired by how such a game even
functions to begin with!</p>

<!--more-->

<h2>What is Netcode?</h2>

<p>If you&#39;ve been keeping along, you know I enjoy networking! The biggest feedback
or complaint that users in Battlefield 4 have are of &quot;netcode&quot;. What is this
&quot;netcode&quot;? I had no idea what it was in the beginning. At first, I assumed it
was just some premium code that users could get and get an advantage in the game
because the statements I saw were things like &quot;F--- netcode&quot; or &quot;Wow, you only
killed me because of netcode&quot;. I later looked it up and all it means is the
network programming code in the game that pretty much manages everything!</p>

<p>A prime example of <em>raging</em> against &quot;netcode&quot; would be if two players are
shooting at each other and Player A kills Player B and Player B sees a clear
&quot;hit&quot; indicator on his screen to show that his shot hit the player but Player A
either has taken no damage or isn&#39;t killed. I&#39;ve seen this a lot and I&#39;m quite
unhappy with it. This brings up a major perception issue. What has happened is
that Player B&#39;s game decided that the hit was good but then the gaming logic
or &quot;netcode&quot; when communicating with Player A&#39;s game and the server decided it
wasn&#39;t good at all.</p>

<h2>Why Does it Happen?</h2>

<p>There isn&#39;t any reason this should happen but I assume that the developers
just messed up the logic. If Player B&#39;s shot didn&#39;t hit Player A then there
should be NO indication of it. There are, however, three main systems in play:</p>

<ol>
<li>Player A&#39;s gaming client.</li>
<li>Player B&#39;s gaming client.</li>
<li>The game server.</li>
</ol>

<p>All three programs need to work together! They can range from being so far apart
with 0 ms to 250 ms pings (if not more but most servers don&#39;t tolerate more than
250 ms pings) that you literally can get up to 1 second of delays!
I&#39;ve never designed a distributed gaming system so if you are reading this and
have had experience, please enlighten me as I&#39;m curious on what actually is
implemented.</p>

<table><thead>
<tr>
<th align="left">Action</th>
<th align="center">Delay</th>
</tr>
</thead><tbody>
<tr>
<td align="left">B tells Server that he shot.</td>
<td align="center">250 ms</td>
</tr>
<tr>
<td align="left">Server tells A that a shot was made.</td>
<td align="center">250 ms</td>
</tr>
<tr>
<td align="left">A tells Server that the shot was no good.</td>
<td align="center">250 ms</td>
</tr>
<tr>
<td align="left">Server tells B that the shot was no good.</td>
<td align="center">250 ms</td>
</tr>
<tr>
<td align="left">Total</td>
<td align="center">1 sec</td>
</tr>
</tbody></table>

<h2>My Thoughts</h2>

<p>Now, obviously I bet that there are shortcuts being made that most communication
is made with the server and the server has the &quot;true&quot; information. So we can
mostly bring it down to just half a second time of communication to say whether
we hit the target or not. But then again another optimization is sometimes made
in that for a smooth game play experience since data is always being
communicated and the clients have some information about other users, that it
can predict whether a shot was a hit or not based on that data and thus show
a hit before any verification of it occurs! This is a lie to user perception if
the guess was wrong!</p>

<p>So I&#39;m guessing the biggest bugs are actually optimizations that are made on the
client side! Thus users are perceiving actions that are predicted to be
incorrect and this causes <em>rage</em> against &quot;netcode&quot;.</p>

<p>I for one am not happy about it, but I understand that designing a game is
complex. It does ruin part of the game play when your game
indicates a clear hit or kill but in reality it actually isn&#39;t. If the design
of the game eliminates such discrepancies then we&#39;d all actually be much
happier! Lies are the worst enemies and when we have proof, we are pissed.</p>

<p>I could go on and on discussing this topic actually, feel free to comment on
your thoughts. Maybe another idea to cause discussion is how do you know if
somebody actually hit someone in game when there is some delay or even a
range of delays?</p>


  
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'richardhsu'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
  
</div>

    <!-- /End Posts Listing -->
    <center><a href="http://fontawesome.io">Font Awesome</a> by Dave Gandy</center>
  </div>
</div>
</body>
</html>
